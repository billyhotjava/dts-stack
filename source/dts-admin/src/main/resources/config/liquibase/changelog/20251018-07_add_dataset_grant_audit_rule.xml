<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd">

    <changeSet id="20251018-07-add-rule" author="gemini-cli">
        <insert tableName="audit_operation_mapping">
            <column name="url_pattern" value="/api/catalog/datasets/{datasetId}/grants"/>
            <column name="http_method" value="POST"/>
            <column name="status_code_regex" value="2\d\d"/>
            <column name="source_system" value="platform"/>
            <column name="module_name" value="catalog"/>
            <column name="action_type" value="UPDATE"/>
            <column name="description_template" value="更新了数据集【{path.datasetId}】的访问权限"/>
            <column name="source_table_template" value="catalog_dataset"/>
            <column name="param_extractors" value="[{"name":"datasetId","source":"path","path":"datasetId"}]"/>
            <column name="event_class" value="DataAssetEvent"/>
            <column name="order_value" value="550"/>
            <column name="enabled" value="true"/>
            <column name="version" value="1.0"/>
            <column name="updated_by" value="gemini-cli"/>
            <column name="updated_at" valueDate="${now}"/>
        </insert>
    </changeSet>
</databaseChangeLog>

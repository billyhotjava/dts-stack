<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd">

    <changeSet id="20251018-08-add-missing-admin-rules" author="gemini-cli">
        <comment>Add missing audit rules for AdminApiResource</comment>

        <insert tableName="audit_operation_mapping">
            <column name="url_pattern" value="/api/admin/change-requests"/>
            <column name="http_method" value="POST"/>
            <column name="module_name" value="审批管理"/>
            <column name="action_type" value="新增"/>
            <column name="description_template" value="提交新的变更请求"/>
            <column name="source_table_template" value="变更申请"/>
            <column name="order_value" valueNumeric="60"/>
            <column name="enabled" valueBoolean="true"/>
        </insert>

        <insert tableName="audit_operation_mapping">
            <column name="url_pattern" value="/api/admin/portal-menus"/>
            <column name="http_method" value="GET"/>
            <column name="module_name" value="菜单管理"/>
            <column name="action_type" value="查询"/>
            <column name="description_template" value="查询门户菜单"/>
            <column name="source_table_template" value="门户菜单"/>
            <column name="order_value" valueNumeric="60"/>
            <column name="enabled" valueBoolean="true"/>
        </insert>

        <insert tableName="audit_operation_mapping">
            <column name="url_pattern" value="/api/admin/portal-menus"/>
            <column name="http_method" value="POST"/>
            <column name="module_name" value="菜单管理"/>
            <column name="action_type" value="新增"/>
            <column name="description_template" value="创建门户菜单"/>
            <column name="source_table_template" value="门户菜单"/>
            <column name="order_value" valueNumeric="60"/>
            <column name="enabled" valueBoolean="true"/>
        </insert>

        <insert tableName="audit_operation_mapping">
            <column name="url_pattern" value="/api/admin/portal-menus/{id}"/>
            <column name="http_method" value="PUT"/>
            <column name="module_name" value="菜单管理"/>
            <column name="action_type" value="修改"/>
            <column name="description_template" value="更新门户菜单: {path.id}"/>
            <column name="source_table_template" value="门户菜单"/>
            <column name="order_value" valueNumeric="59"/>
            <column name="enabled" valueBoolean="true"/>
        </insert>

        <insert tableName="audit_operation_mapping">
            <column name="url_pattern" value="/api/admin/portal-menus/{id}"/>
            <column name="http_method" value="DELETE"/>
            <column name="module_name" value="菜单管理"/>
            <column name="action_type" value="删除"/>
            <column name="description_template" value="删除门户菜单: {path.id}"/>
            <column name="source_table_template" value="门户菜单"/>
            <column name="order_value" valueNumeric="59"/>
            <column name="enabled" valueBoolean="true"/>
        </insert>

        <insert tableName="audit_operation_mapping">
            <column name="url_pattern" value="/api/admin/portal-menus/reset"/>
            <column name="http_method" value="POST"/>
            <column name="module_name" value="菜单管理"/>
            <column name="action_type" value="执行"/>
            <column name="description_template" value="重置门户菜单"/>
            <column name="source_table_template" value="门户菜单"/>
            <column name="order_value" valueNumeric="60"/>
            <column name="enabled" valueBoolean="true"/>
        </insert>

    </changeSet>
</databaseChangeLog>

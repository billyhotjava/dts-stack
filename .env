# ====== Base & Traefik ======
BASE_DOMAIN=dts.local
TLS_PORT=443
TRAEFIK_DASHBOARD=true
TRAEFIK_DASHBOARD_PORT=8080
TRAEFIK_METRICS_PORT=9100
TRAEFIK_ENABLE_PING=true

# ====== Build Helpers ======
IMAGE_MAVEN=maven:3.9.9-eclipse-temurin-21
KEYTOOL_IMAGE=maven:3.9.9-eclipse-temurin-21
KEYTOOL_IMAGE_STRICT=true

# ====== Hosts ======
HOST_SSO=sso.dts.local
HOST_TRINO=trino.dts.local
HOST_API=api.dts.local
HOST_RANGER=ranger.dts.local
HOST_ADMIN_UI=biadmin.dts.local
HOST_PLATFORM_UI=bi.dts.local
HOST_SUPERSET=superset.dts.local
HOST_METABASE=metabase.dts.local
HOST_GATEWAY_IP=192.168.27.39

# ====== Keycloak ======
KC_ADMIN=admin
KC_ADMIN_PWD=Devops123@
KC_HTTP_ENABLED=true
KC_HOSTNAME=sso.dts.local
KC_HOSTNAME_PORT=443
KC_HOSTNAME_URL=https://sso.dts.local
KC_HOSTNAME_STRICT=true
KC_HOSTNAME_STRICT_HTTPS=true
KC_DB_URL_PROPERTIES=sslmode=disable
KC_REALM=S10
OIDC_ISSUER_URI=https://sso.dts.local/realms/S10
TRUSTSTORE_PASSWORD=changeit

# ====== Postgres (mode/host filled later) ======
PG_AUTH_METHOD=scram
PG_MODE=embedded
PG_HOST=dts-pg
PG_SUPER_USER=postgres
PG_SUPER_PASSWORD=Devops123@
PG_PORT=5432

# --- Keycloak DB triplet ---
PG_DB_KEYCLOAK=dts_keycloak
PG_USER_KEYCLOAK=dts_keycloak
PG_PWD_KEYCLOAK=Devops123@

# --- dts-admin (compose 直连用这些名) ---
DTADMIN_DB_NAME=dts_admin
DTADMIN_DB_USER=dts_admin
DTADMIN_DB_PASSWORD=Devops123@
DTADMIN_API_PORT=18081

# --- dts-admin PG triplet (for dts-pg init) ---
PG_DB_DTADMIN=dts_admin
PG_USER_DTADMIN=dts_admin
PG_PWD_DTADMIN=Devops123@

# --- dts-platform triplet ---
PG_DB_DTPS=dts_platform
PG_USER_DTPS=dts_platform
PG_PWD_DTPS=Devops123@

# --- dts-common triplet ---
PG_DB_DTCOMMON=dts_common
PG_USER_DTCOMMON=dts_common
PG_PWD_DTCOMMON=Devops123@

# --- Superset metadata ---
PG_DB_SUPERSET=superset
PG_USER_SUPERSET=superset
PG_PWD_SUPERSET=Devops123@

# --- Metabase metadata ---
PG_DB_METABASE=metabase
PG_USER_METABASE=metabase
PG_PWD_METABASE=Devops123@


# ====== OIDC Clients ======
OAUTH2_ADMIN_CLIENT_ID=dts-system
OAUTH2_ADMIN_CLIENT_SECRET=Devops123@
OAUTH2_PLATFORM_CLIENT_ID=dts-system
OAUTH2_PLATFORM_CLIENT_SECRET=Devops123@

# ====== Admin PKI ======
DTS_PKI_ENABLED=true
DTS_PKI_MODE=gateway
DTS_PKI_ALLOW_MOCK=false
DTS_PKI_ACCEPT_FORWARDED_CERT=false
DTS_PKI_CLIENT_CERT_HEADER_NAME=X-Forwarded-Tls-Client-Cert
DTS_PKI_ISSUER_CN=
DTS_PKI_API_BASE=
DTS_PKI_API_TOKEN=
DTS_PKI_API_TIMEOUT=3000
DTS_PKI_GATEWAY_HOST=
DTS_PKI_GATEWAY_PORT=0
DTS_PKI_GATEWAY_ALT_PORT=10009
DTS_PKI_GATEWAY_ENDPOINT=/wglogin
DTS_PKI_DIGEST=SHA1
DTS_PKI_VENDOR_JAR=/opt/dts/vendor
DTS_ADMIN_JAVA_TOOL_OPTIONS_EXTRA=--add-exports=java.base/sun.security.x509=ALL-UNNAMED\ --add-exports=java.base/sun.security.util=ALL-UNNAMED\ --add-opens=java.base/sun.security.x509=ALL-UNNAMED\ --add-opens=java.base/sun.security.util=ALL-UNNAMED

# ====== Admin password-login IP allowlist (triad only; PKI unaffected) ======
DTS_SECURITY_IP_ALLOWLIST_ENABLED=true
DTS_SECURITY_IP_ALLOWLIST_TRIAD_USERNAMES=sysadmin,authadmin,auditadmin

# ====== Frontend PKI defaults ======
VITE_ADMIN_API_BASE_URL=/admin/api
VITE_ADMIN_PROXY_TARGET=
VITE_KOAL_PKI_ENDPOINTS=https://127.0.0.1:16080,http://127.0.0.1:18080
KOAL_VENDOR_BASE=/vendor/koal
VITE_KOAL_VENDOR_BASE=/vendor/koal
KOAL_PKI_ENDPOINTS=https://127.0.0.1:16080,http://127.0.0.1:18080
ADMIN_WEBAPP_PASSWORD_LOGIN_ENABLED=true
ADMIN_VITE_HIDE_PASSWORD_LOGIN=false
PLATFORM_WEBAPP_PASSWORD_LOGIN_ENABLED=
PLATFORM_VITE_HIDE_PASSWORD_LOGIN=true

# ====== Superset ======
SUPERSET_SECRET_KEY=gvMnJcCKutMI6EFxSMNMLzHV-GD2RY50hz_UzoHih7M=
SUPERSET_LOAD_EXAMPLES=false
SUPERSET_FEATURE_FLAGS={
SUPERSET_ADMIN_USERNAME=superset
SUPERSET_ADMIN_PASSWORD=Devops123@
SUPERSET_ADMIN_EMAIL=superset@dts.local
SUPERSET_ADMIN_FIRST_NAME=Superset
SUPERSET_ADMIN_LAST_NAME=Admin
SUPERSET_CONFIG_PATH=
SUPERSET_WEBSERVER_WORKERS=2
SUPERSET_WEBSERVER_TIMEOUT=120
SUPERSET_EXTRA_CLI_ARGS=
SUPERSET_OIDC_CLIENT_ID=superset
SUPERSET_OIDC_CLIENT_SECRET=Devops123@
SUPERSET_OIDC_METADATA_URL=https://sso.dts.local/realms/S10/.well-known/openid-configuration
SUPERSET_OIDC_REDIRECT_URI=https://superset.dts.local/oauth-authorized/keycloak
SUPERSET_OIDC_LOGOUT_URL=https://sso.dts.local/realms/S10/protocol/openid-connect/logout
SUPERSET_OIDC_SCOPES=openid,profile,email

# ====== Metabase ======
METABASE_ENCRYPTION_SECRET=Nx4I1QfWiNVKqcAwkZXeiYJ5EOhEJQWZ6oRbYYdTCFo=
METABASE_SITE_URL=https://metabase.dts.local
METABASE_JAVA_TOOL_OPTIONS="-Xms512m -Xmx1024m"
METABASE_OIDC_CLIENT_ID=metabase
METABASE_OIDC_CLIENT_SECRET=Devops123@
METABASE_OIDC_REDIRECT_URI=https://metabase.dts.local/auth/sso
METABASE_OIDC_METADATA_URL=https://sso.dts.local/realms/S10/.well-known/openid-configuration

# ====== MDM Gateway ======
DTS_MDM_GATEWAY_ENABLED=true
DTS_MDM_GATEWAY_STORAGE_PATH=data/mdm
DTS_MDM_GATEWAY_LOG_PATH=logs/mdm-gateway.log
DTS_MDM_UPSTREAM_BASE_URL=http://mdm-upstream.example.com
DTS_MDM_UPSTREAM_PULL_PATH=/api/mdm/pull
DTS_MDM_UPSTREAM_AUTH_TOKEN=
DTS_MDM_UPSTREAM_CONNECT_TIMEOUT=5s
DTS_MDM_UPSTREAM_READ_TIMEOUT=30s
DTS_MDM_CALLBACK_AUTH_TOKEN=
DTS_MDM_CALLBACK_SIGNATURE_HEADER=X-Signature
DTS_MDM_REQUIRED_FIELDS=orgCode,deptCode,status

# ====== Admin IP 白名单（由 init.sh 生成） ======
ADMIN_ALLOWED_IPS=
ADMIN_BACKUP_IPS=
ADMIN_WHITELIST_CIDRS=0.0.0.0/0

# ====== Ranger (Admin) ======
PG_DB_RANGER=dts_ranger
PG_USER_RANGER=dts_ranger
PG_PWD_RANGER=Devops123@
RANGER_ADMIN_PASSWORD=Devops123@
RANGER_TAGSYNC_PASSWORD=Devops123@
RANGER_USERSYNC_PASSWORD=Devops123@

# ====== YTS 服务数据库 ======
IAM_DB_NAME=iam
IAM_DB_USER=iam
IAM_DB_PASSWORD=Devops123@
GOVERNANCE_DB_NAME=governance
GOVERNANCE_DB_USER=governance
GOVERNANCE_DB_PASSWORD=Devops123@
EXPLORE_DB_NAME=explore
EXPLORE_DB_USER=explore
EXPLORE_DB_PASSWORD=Devops123@
LEGACY_STACK=false
IMAGE_TRAEFIK=traefik:v3.6.0
IMAGE_POSTGRES=postgres:17.6
IMAGE_KEYCLOAK=quay.io/keycloak/keycloak:26.3.4
IMAGE_TRINO=trinodb/trino:451
IMAGE_SUPERSET=dts-superset:2.1.3
IMAGE_METABASE=dts-metabase:0.49.15
IMAGE_DTS_ADMIN=dts-admin:1.0.0
IMAGE_DTS_PLATFORM=dts-platform:1.0.0
IMAGE_DTS_ADMIN_WEBAPP=dts-admin-webapp:1.0.0
IMAGE_DTS_PLATFORM_WEBAPP=dts-platform-webapp:1.0.0
DEPLOY_MODE=single
